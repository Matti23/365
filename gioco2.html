<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Labirinto Segreto</title>
<link rel="shortcut icon" href="./images/cuore.png" type="image/x-icon">
<style>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: radial-gradient(circle at center, #0d0d0d, #1a1a1a, #0d0d0d);
    font-family: 'Comic Sans MS', cursive, sans-serif;
    color: #fff;
  }

  body {
    opacity: 0;
    transform: translateY(-20px);
    transition: opacity 1.5s ease, transform 1.5s ease;
  }

  body.loaded {
    opacity: 1;
    transform: translateY(0);
  }

  h1 {
    text-align: center;
    margin: 10px 0;
    font-size: 2em;
    text-shadow: 0 0 10px #ff3366, 0 0 20px #ffcc00;
  }

  p {
    text-align: center;
    font-size: 1.1em;
    color: #eee;
  }

  #gioco-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 20px;
    margin-top: 20px;
    flex-wrap: wrap;
  }

  #labirinto {
    display: grid;
    grid-template-columns: repeat(16, 1fr);
    grid-template-rows: repeat(16, 1fr);
    gap: 2px;
    max-width: 90vw;
    max-height: 80vh;
    background: #111;
    padding: 4px;
    border-radius: 12px;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    animation: glow 2s infinite alternate;
  }

  @keyframes glow {
    from { box-shadow: 0 0 10px rgba(255,255,255,0.2); }
    to { box-shadow: 0 0 25px rgba(255,255,255,0.4); }
  }

  .cella {
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: clamp(10px, 1.5vw, 20px);
    border-radius: 5px;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .cella:hover {
    transform: scale(1.05);
    box-shadow: 0 0 8px rgba(255,255,255,0.5);
  }

  .muro { 
    background: linear-gradient(135deg, #006699, #0099cc);
    box-shadow: inset 0 0 4px #00ccff;
  }

  .giocatore { 
    background: radial-gradient(circle, #ff3366, #ff6699);
    animation: pulse 1s infinite alternate;
  }

  @keyframes pulse {
    from { box-shadow: 0 0 8px #ff3366; }
    to { box-shadow: 0 0 15px #ff99aa; }
  }

  .arrivo-bloccata { 
    background: #555;
    color: #222;
    font-weight: bold;
  }

  .arrivo-sbloccata { 
    background: radial-gradient(circle, #ffcc00, #ffaa00);
    animation: shine 1s infinite alternate;
    font-weight: bold;
  }

  @keyframes shine {
    from { box-shadow: 0 0 8px #ffcc00; }
    to { box-shadow: 0 0 20px #ffff66; }
  }

  .oggetto { 
    background: linear-gradient(135deg, #8bc34a, #4caf50);
    color: white;
    font-weight: bold;
    font-size: clamp(14px, 1.8vw, 22px);
    box-shadow: 0 0 8px #8bc34a;
    animation: bounce 1s infinite alternate;
  }

  @keyframes bounce {
    from { transform: translateY(0); }
    to { transform: translateY(-4px); }
  }

  #oggetti-rimasti {
    font-size: 16px;
    text-align: center;
    margin-top: 10px;
    text-shadow: 0 0 5px #fff;
  }

  .colonna-indizi {
    width: 180px;
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .indizio {
    background: linear-gradient(135deg, #ffe4b5, #ffdd99);
    border: 2px solid #ff9800;
    border-radius: 12px;
    padding: 6px 10px;
    font-size: 13px;
    color: #333;
    box-shadow: 2px 2px 8px rgba(0,0,0,0.3);
    transition: transform 0.3s, box-shadow 0.3s;
  }

  .indizio:hover {
    transform: scale(1.05) rotate(-1deg);
    box-shadow: 4px 4px 12px rgba(0,0,0,0.4);
  }

  /* CANDELE */
  .candle {
    position: absolute;
    bottom: 20px;
    width: 40px;
    height: 120px;
    background: #fff5e6;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(255,200,150,0.8);
  }
  .candle::before {
    content: '';
    position: absolute;
    top: -25px;
    left: 50%;
    transform: translateX(-50%);
    width: 16px;
    height: 25px;
    background: radial-gradient(circle, rgba(255,220,0,1) 0%, rgba(255,140,0,0.9) 60%, transparent 100%);
    border-radius: 50%;
    animation: flicker 0.4s infinite alternate;
  }
  .candle.left { left: 5%; }
  .candle.right { right: 5%; }

  @keyframes flicker {
    from { opacity: 0.9; transform: translateX(-50%) scaleY(1); }
    to { opacity: 1; transform: translateX(-50%) scaleY(1.1); }
  }
</style>
</head>
<body>
<div class="candle left"></div>
<div class="candle right"></div>

<h1>Labirinto Segreto</h1>
<p>Raccogli tutti gli oggetti e raggiungi il traguardo! Usa le frecce della tastiera.</p>
<p id="oggetti-rimasti">Oggetti rimasti: 12</p>

<div id="gioco-container">
  <div id="indizi-sinistra" class="colonna-indizi"></div>
  <div id="labirinto"></div>
  <div id="indizi-destra" class="colonna-indizi"></div>
</div>

<script>
// Labirinto: 0=strada, 1=muro, 2=giocatore, 3=arrivo, 4=oggetto
const lab = [
  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
  [1,2,0,0,1,0,0,0,1,4,0,0,0,1,4,1],
  [1,0,1,0,1,4,1,0,1,1,1,0,0,0,0,1],
  [1,0,0,0,1,1,0,0,0,0,0,0,1,0,1,1],
  [1,0,1,1,4,1,0,1,0,1,0,1,0,1,0,1],
  [1,0,0,0,0,1,0,0,0,1,0,4,0,0,0,1],
  [1,0,1,1,0,1,4,1,0,1,0,1,0,1,0,1],
  [1,0,0,1,1,0,0,1,0,4,0,1,0,0,4,1],
  [1,0,0,0,1,1,0,1,0,0,0,1,0,0,0,1],
  [1,0,0,1,0,1,0,0,0,1,0,0,4,1,0,1],
  [1,0,1,0,0,0,0,1,0,0,0,1,1,0,0,1],
  [1,4,0,0,0,1,4,0,0,0,1,0,0,1,0,1],
  [1,0,1,0,0,1,1,1,0,1,0,1,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],
  [1,0,0,1,0,0,1,0,0,1,0,0,0,0,4,1],
  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1]
];

let giocatore = {x:1, y:1};
let oggettiRimasti = 12;

// Emoji e indizi
const emojiOggetti = ['ğŸ°','â›ª','ğŸŒŠ','ğŸ¨','ğŸŸï¸','ğŸŒ³','ğŸ—½','ğŸ›ï¸','ğŸ•°ï¸','ğŸ†','ğŸ’ƒ','ğŸ¥‚'];
const mappaIndizi = {
  'ğŸ°': "Tra torri dalle forme strane e colori vivaci, camminare insieme Ã¨ un sognoâ€¦ ğŸ°",
  'â›ª': "Una maestosa struttura vi osserva silenziosa, custode di emozioni segreteâ€¦ â›ª",
  'ğŸŒŠ': "Passeggiate lungo la riva, il suono delle onde accompagna i vostri sguardiâ€¦ ğŸŒŠ",
  'ğŸ¨': "Vicoli stretti e pieni di arte, ogni angolo sussurra storie da scoprire insiemeâ€¦ ğŸ¨",
  'ğŸŸï¸': "Tra applausi e urla di gioia, sentite il cuore battere allâ€™unisonoâ€¦ ğŸŸï¸",
  'ğŸŒ³': "Giardini nascosti tra alberi e fiori, un rifugio dove tutto sembra possibileâ€¦ ğŸŒ³",
  'ğŸ—½': "Dallâ€™alto di una collina, la cittÃ  vi avvolge in un abbraccio infinitoâ€¦ ğŸ—½",
  'ğŸ›ï¸': "Strade e piazze antiche dove ogni passo diventa un ricordo condivisoâ€¦ ğŸ›ï¸",
  'ğŸ•°ï¸': "Il tempo sembra fermarsi tra lampioni e risate, mentre camminate mano nella manoâ€¦ ğŸ•°ï¸",
  'ğŸ†': "Il cielo esplode in luci e colori, e i vostri occhi brillano piÃ¹ delle stelleâ€¦ ğŸ†",
  'ğŸ’ƒ': "Tra ritmi caldi e passi di danza, vi lasciate trasportare dalla gioiaâ€¦ ğŸ’ƒ",
  'ğŸ¥‚': "Brindisi sotto le luci della notte, un nuovo anno che inizia con voiâ€¦ ğŸ¥‚"
};

// Mappa emoji
let labEmoji = [];
let index = 0;
for(let y=0; y<16; y++){
  labEmoji[y] = [];
  for(let x=0; x<16; x++){
    labEmoji[y][x] = lab[y][x] === 4 ? emojiOggetti[index++] : '';
  }
}

const labirinto = document.getElementById("labirinto");
const oggettiText = document.getElementById("oggetti-rimasti");
const divSinistra = document.getElementById("indizi-sinistra");
const divDestra = document.getElementById("indizi-destra");

function disegnaLabirinto(){
  labirinto.innerHTML = '';
  for(let y=0; y<16; y++){
    for(let x=0; x<16; x++){
      const div = document.createElement('div');
      div.classList.add('cella');
      if(lab[y][x] === 1) div.classList.add('muro');
      if(lab[y][x] === 2) div.classList.add('giocatore');
      if(lab[y][x] === 3){
        div.classList.add(oggettiRimasti === 0 ? 'arrivo-sbloccata' : 'arrivo-bloccata');
        div.innerText = oggettiRimasti === 0 ? 'ğŸ' : 'ğŸ”’';
      }
      if(lab[y][x] === 4){
        div.classList.add('oggetto');
        div.innerText = labEmoji[y][x];
      }
      labirinto.appendChild(div);
    }
  }
  aggiornaDimensioniCelle();
}

// Funzione per celle quadrate
function aggiornaDimensioniCelle() {
  const labWidth = labirinto.clientWidth;
  const labHeight = labirinto.clientHeight;
  const size = Math.min(labWidth / 16, labHeight / 16);
  labirinto.querySelectorAll('.cella').forEach(cella => {
    cella.style.width = size + 'px';
    cella.style.height = size + 'px';
  });
}

// Movimento giocatore
document.addEventListener('keydown', (e)=>{
  let nx = giocatore.x;
  let ny = giocatore.y;
  if(e.key === 'ArrowUp') ny--;
  if(e.key === 'ArrowDown') ny++;
  if(e.key === 'ArrowLeft') nx--;
  if(e.key === 'ArrowRight') nx++;

  if(nx < 0 || nx >= 16 || ny < 0 || ny >= 16) return;
  if(lab[ny][nx] === 1 || (lab[ny][nx] === 3 && oggettiRimasti > 0)) return;

  if(lab[ny][nx] === 4){
    const emoji = labEmoji[ny][nx];
    oggettiRimasti--;
    const div = document.createElement('div');
    div.classList.add('indizio');
    div.innerText = mappaIndizi[emoji];
    if(12 - oggettiRimasti <= 6) divSinistra.appendChild(div);
    else divDestra.appendChild(div);
    lab[ny][nx] = 0;
    labEmoji[ny][nx] = '';
    oggettiText.innerText = "Oggetti rimasti: " + oggettiRimasti;
  }

  if(lab[ny][nx] === 0){
    lab[giocatore.y][giocatore.x] = 0;
    giocatore.x = nx;
    giocatore.y = ny;
    lab[ny][nx] = 2;
  }

  if(lab[ny][nx] === 3 && oggettiRimasti === 0){
    window.location.href = "finale.html";
    return;
  }

  disegnaLabirinto();
});

disegnaLabirinto();
window.addEventListener('resize', aggiornaDimensioniCelle);

window.onload = () => {
  document.body.classList.add("loaded");
};
</script>
</body>
</html>
